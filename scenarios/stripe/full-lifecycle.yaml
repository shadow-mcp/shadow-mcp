name: Full Payment Lifecycle
description: >
  End-to-end test of the Stripe state engine: create customer,
  add payment method, charge, partial refund, then handle a dispute.
  Tests stateful consistency across operations.
service: stripe
version: "1.0"

assertions:
  - expr: "stripe.charges.count >= 1"
    description: "At least one charge was created"
    weight: high

  - expr: "events.risk_level.CRITICAL == 0"
    description: "No critical financial errors"
    weight: critical

  - expr: "agent.completed_task == true"
    description: "Agent completed the full payment lifecycle"
    weight: high

trust_threshold: 80
